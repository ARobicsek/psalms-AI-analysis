================================================================================
SKIPGRAM EXTRACTION ISSUE - EXECUTIVE SUMMARY
================================================================================

CRITICAL FINDING:
38.29% of "skipgrams" stored in the database have gap_word_count=0
This means they are CONTIGUOUS patterns with NO GAPS - not true skipgrams!

Current State:
- Total skipgrams: 13,804
- Contiguous (gap=0): 5,285 (38.29%) - SHOULD NOT BE SKIPGRAMS
- True skipgrams (gap>0): 8,519 (61.71%) - Correct

THE PROBLEM:
Skipgrams BY DEFINITION must have gaps between matched words.
A pattern with no gaps is a contiguous phrase, not a skipgram.
These should be stored separately in the contiguous_phrases collection.

ROOT CAUSE:
The extraction algorithm generates ALL n-word combinations within a window
using combinations(), which includes both contiguous and non-contiguous pairs.
There's no filtering to exclude gap_word_count=0 patterns.

THE FIX:
Add a simple check in skipgram_extractor_v4.py after calculating gap_word_count:

    if gap_word_count == 0:
        continue  # Skip this pattern entirely

Location: Line 297-298 in extract_skipgrams_with_verse()

EXPECTED RESULTS:
After fix:
- Contiguous patterns: 0 (removed from skipgrams)
- True skipgrams: 8,519 (unchanged)
- Total reduction: 38.29% fewer patterns
- Quality: Much improved (correct definition)

IMPLEMENTATION:
1. Add 3 lines to skipgram_extractor_v4.py (gap check)
2. Add 1 line to __init__ (statistics tracking)
3. Run migration to regenerate database
4. Verify no gap_word_count=0 in results

IMPACT:
- Skipgrams collection becomes definitionally correct
- Scoring may change (fewer patterns counted)
- Rankings may shift (more accurate)
- No functional breaking changes

DETAILED DOCUMENTATION:
See: /home/user/psalms-AI-analysis/docs/SKIPGRAM_GAP_ISSUE_ANALYSIS.md
See: /home/user/psalms-AI-analysis/docs/SKIPGRAM_GAP_FIX_IMPLEMENTATION.md

FILES AFFECTED:
1. scripts/statistical_analysis/skipgram_extractor_v4.py (lines 297-302)
2. scripts/statistical_analysis/migrate_skipgrams_v4.py (statistics reporting)
3. data/psalm_relationships.db (will be regenerated)

RISK LEVEL: LOW
- Only removes definitionally incorrect patterns
- No changes to scoring algorithm
- Backward compatible with existing scoring code
- Easy to rollback if needed

ACTION REQUIRED:
Ready to implement when approved. The fix is simple and low-risk.

================================================================================
